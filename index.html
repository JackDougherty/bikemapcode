<!DOCTYPE html>
<html lang='en'>
<head>
	<title>bikemapcode</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
	<link rel="shortcut icon" href="favicon.ico">
	<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
	<link rel="stylesheet" href="css/bootstrap.min.css"/>
	<script src="src/Control.Geocoder.js"></script>
	<link rel="stylesheet" href="css/Control.Geocoder.css"/>
	<script src="layer/vector/GPX.js"></script>
	<script src="layer/vector/KML.js"></script>
	<!-- trying to make Google tile work <script src="layer/tile/Google.js"></script>-->
	<!-- Load Esri Leaflet from CDN, rather than local: <script src="lib/esri-leaflet/esri-leaflet.js"></script>-->
  	<script src="http://cdn-geoweb.s3.amazonaws.com/esri-leaflet/1.0.0-rc.2/esri-leaflet.js"></script>
	<script src="src/L.Control.Locate.js"></script>
	<link rel="stylesheet" href="css/L.Control.Locate.css"/>
	<script src="src/leaflet-compass.js"></script>
	<link rel="stylesheet" href="css/leaflet-compass.css"/>
	<script src="src/leaflet-sidebar.js"></script>
	<link rel="stylesheet" href="css/leaflet-sidebar.css" />

	<!--[if lt IE 9]>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.ie.css" />
		<link rel="stylesheet" href="css/L.Control.Locate.ie.css"/>
		<![endif]-->
	<link rel="stylesheet" href="css/custom.css"/>
</head>
<body>

	<div id="sidebar" class="sidebar collapsed">
		<!-- Nav tabs -->
		<ul class="sidebar-tabs" role="tablist">
			<li><a href="#home" role="tab"><i class="fa fa-comment"></i></a></li>
		</ul>

		<!-- Tab panes -->
		<div class="sidebar-content active">
			<div class="sidebar-pane" id="home">
			<h2>bikemapcode</h2>
			<p>Free map code for your bike group's website. Cycling organizations may freely use this mobile-friendly tool to display recommended bicycle routes and facilities on their own web sites. Riders with smartphones can automatically find their locations and view different map layers. Anyone may edit bike lanes, racks, shops on the default basemap: OpenStreetMap/OpenCycleMap. Customize to display recommended rides or route networks by adding GPX, KML, or ArcGIS overlay maps.</p>
			<h3>legend - to come</h3>
			</div>
		</div>
	</div>

<div id="map"></div>
	<script>
	var ocmUrl = 'http://{s}.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png',
	ocmAttr = 'Map data &copy; <a href="http://www.opencyclemap.org">OpenCycleMap</a> and <a href="http://openstreetmap.org">OpenStreetMap</a> contributors <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
	osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
	osmAttr = 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>';
	var ocm   = L.tileLayer(ocmUrl, {attribution: ocmAttr}),
	osm   = L.tileLayer(osmUrl, {attribution: osmAttr}),
	esriStreets = L.esri.basemapLayer("Streets"),
	// ggl = new L.Google(),
	// ggl2 = new L.Google('TERRAIN'),
	FVTC = new L.GPX("routes/FVTCJune28loop.gpx", {async: true, display_wpt:false}),
	HartfordGISBikeRoutes = L.esri.featureLayer('http://gis1.hartford.gov/arcgis/rest/services/OpenData_Community/MapServer/9',{
		style: function () {
          	return { color: "#70ca49", opacity: 0.7, weight: 5};
        	}
	}),
	TrinGISPrimaryRoutes = L.esri.featureLayer('http://services1.arcgis.com/5rblLCKLgS4Td60j/ArcGIS/rest/services/PrimaryRoutes/FeatureServer/0',{
		style: function () {
          	return { color: "#4BACC6", opacity: 0.7, weight: 5};
        	}
	}),
	TrinGISMuniBikeLanes = L.esri.featureLayer('http://services1.arcgis.com/5rblLCKLgS4Td60j/ArcGIS/rest/services/HartfordMuniBikeLanes/FeatureServer/0',{
		style: function () {
          	return { color: "#00FF00", opacity: 0.7, weight: 5 };
        	}
	}),
	TrinGISMuniBikeLanes_Connex = L.esri.featureLayer('http://services1.arcgis.com/5rblLCKLgS4Td60j/ArcGIS/rest/services/HartfordMuniBikeLanes_Connex/FeatureServer/0',{
		style: function () {
          	return { color: "#9BBB59", opacity: 0.7, weight: 5 };
        	}
	});
	var map = L.map('map', {
	center: [41.77, -72.69],
	zoom: 14,
	zoomControl: false,  // add new zoom control further below, after layer control
	layers: [ocm]   //default display can be base + overlays [ocm, arcGIS, track]
	});
	var baseMaps = {
	"OpenCycleMap": ocm,
	"OpenStreetMap": osm,
	// "Google Terrain": ggl2,
	// "Google Satellite": ggl,
	"ESRI StreetMap": esriStreets
	};
	var overlayMaps = {
	"FVTC June 28 loop (GPX)": FVTC,
	"Hartford city bike lanes (City of Hartford ArcGIS)": HartfordGISBikeRoutes,
	"Hartford area primary routes (Trinity ArcGIS)": TrinGISPrimaryRoutes,
	"Hartford city bike lanes (Trinity ArcGIS)": TrinGISMuniBikeLanes,
	"Hartford city bike lanes connex (Trinity ArcGIS)": TrinGISMuniBikeLanes_Connex
	};
	// position various controls, with margins in CSS custom
	var sidebar = L.control.sidebar('sidebar').addTo(map);
	sidebar.open('home');
	layerControl = L.control.layers(baseMaps, overlayMaps, {position: 'topleft'});
	layerControl.addTo(map);
	new L.Control.Zoom({position: 'topright'}).addTo(map);
	L.control.locate().addTo(map);
	L.Control.geocoder({position: 'topleft'}).addTo(map);
	map.addControl( new L.Control.Compass() );
	
	TrinGISPrimaryRoutes.bindPopup(function (feature) {
    	return L.Util.template('<p>{ID}</p>', feature.properties);
  	});
	</script>
</body>
</html>
