<!DOCTYPE html>
<html lang='en'>
<head>
	<title>bikemapcode</title>
	<meta charset="utf-8">
	<link rel="shortcut icon" href="favicon.ico">
	<!-- Load Leaflet from a https CDN, not http. Look for updates at http://leafletjs.com/download.html -->
	<link rel="stylesheet" href="https://npmcdn.com/leaflet@1.0.0-rc.3/dist/leaflet.css"/>
	<script src="https://npmcdn.com/leaflet@1.0.0-rc.3/dist/leaflet.js"></script>
	<!-- load jQuery  -->
	<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
	<!-- Load Esri Leaflet -->
	<script src="https://cdn.jsdelivr.net/leaflet.esri/2.0.2/esri-leaflet.js"></script>
	<!-- load Font-Awesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
	<!-- load Leaflet.locatecontrol -->
	<script src="https://cdn.jsdelivr.net/leaflet.locatecontrol/0.52.0/L.Control.Locate.min.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/leaflet.locatecontrol/0.52.0/L.Control.Locate.min.css"/>
	<!-- load Leaflet-plugins to read GPX and KML -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-plugins/1.9.0/layer/vector/GPX.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-plugins/1.9.0/layer/vector/KML.min.js"></script>
	<!-- Load leaflet-geocoder to search locations-->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-geocoder-mapzen/1.6.3/leaflet-geocoder-mapzen.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-geocoder-mapzen/1.6.3/leaflet-geocoder-mapzen.js"></script>
	<!-- load compass from local directory -->
	<link rel="stylesheet" href="src/leaflet-compass.min.css"/>
	<script src="src/leaflet-compass.min.js"></script>
	<!-- load distance markers with geometry from local directory; see also style.css -->
	<script src="src/leaflet.geometryutil.js" type="text/javascript"></script>
	<script src="src/leaflet-distance-marker.js" type="text/javascript"></script>
	<!-- load leaflet-sidebar from local directory -->
	<link rel="stylesheet" href="src/L.Control.Sidebar.css" />
	<script src="src/L.Control.Sidebar.js"></script>
	<!-- load custom css -->
	<link rel="stylesheet" href="style.css"/>
</head>
<body>

	<div id="sidebar" class="sidebar collapsed">
		<ul class="sidebar-tabs" role="tablist">
			<li><a href="#home" role="tab"><i class="fa fa-question-circle"></i></a></li>
		</ul>
		<div class="sidebar-content active">
			<div class="sidebar-pane" id="home">
			<strong>bikemapcode</strong> displays mobile-friendly cycling maps on your website with easy-to-modify <a href="https://github.com/JackDougherty/bikemapcode#bikemapcode" target="_blank">open-source code</a>.</p>
			<p><img src="images/layers-icon.png"> Choose map layers:</p>
			<ul>
			<li>Basemaps: <a href="http://opencyclemap.org/" target="_blank">Open Cycle Map</a>, <a href="http://www.openstreetmap.org/" target="_blank">Open Street Map</a>, etc.</li>
			<li>Overlays: add bike routes (KML, GPX, ArcGIS) </li>
			</ul>
			</p>
			<p><img src="images/location-icon.png"> Show your current location</p>
			<p><img src="images/search-icon.png"> Search for any place </p>
			<p><img src="images/compass-icon.png"> Compass arrow (with mobile devices)</p>
		  </br>
			<p>Key for <a href="http://www.opencyclemap.org/docs/" target="_blank">OpenCycleMap</a></p>
			<img src="images/OpenCycleMapKey.png">
		  </br>
			<p>bikemapcode is distributed as-is with no warranty under an MIT license. Feedback and code contributions welcome on <a href="https://github.com/JackDougherty/bikemapcode" target="_blank">GitHub</a> or email to <a href="mailto:jack.dougherty@trincoll.edu">jack.dougherty@trincoll.edu</a></p>
			</div>
		</div>
	</div>

<div id="map"></div>
	<script>
	var map = L.map('map', {
	  center: [41.76,-72.69],
	  zoom: 13,
	  zoomControl: false, // add later to reposition
	  scrollWheelZoom: false
	});

	map.attributionControl
	.setPrefix("View <a href='http://github.com/jackdougherty/bikemapcode'>code on GitHub</a> with <a href='http://leafletjs.com' title='A JS library for interactive maps'>Leaflet</a>");

	var controlLayers = L.control.layers( null, null, {
	  position: "topleft",
	  collapsed: false
	}).addTo(map);

	L.control.locate({
		locateOptions: {maxZoom: 16}, // default = 18
		strings: {title: "Show my location"} // To do: resize icon to make text appear alongside
	}).addTo(map);

	new L.control.zoom({position: "topleft",}).addTo(map);

	L.control.scale().addTo(map);

	map.addControl( new L.Control.Compass() );

	var EsriStreets = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}', {
		attribution: 'Tiles &copy; Esri'
	}).addTo(map);
	controlLayers.addBaseLayer(EsriStreets, 'Esri Streets');

	var OSM = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		maxZoom: 19,
		attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
	});
	controlLayers.addBaseLayer(OSM, 'Open Street Map');

	var OCM = L.tileLayer('https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=1d12526533cd4f0f9f1e166c7bb855d7', {
		attribution: 'Maps &copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, Data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
	});
	controlLayers.addBaseLayer(OCM, 'Open Cycle Map');

	var HartGISBike = L.esri.featureLayer({
    url: 'http://gis1.hartford.gov/arcgis/rest/services/OpenData_Community/MapServer/9',
		style: function () {
			return { color: "#70ca49", opacity: 0.7, weight: 5};
		}
	});
	controlLayers.addOverlay(HartGISBike, 'City of Hartford bike lanes');

	// var TrinGISPrimaryRoutes = L.esri.featureLayer('http://services1.arcgis.com/5rblLCKLgS4Td60j/ArcGIS/rest/services/PrimaryRoutes/FeatureServer/0',{
	// 	style: function () {
  //         	return { color: "#4BACC6", opacity: 0.7, weight: 5};
  //       	}
	// });
	// controlLayers.addOverlay(gb10, 'Glastonbury 10 mile (blue)');
	//
	// var TrinGISMuniBikeLanes = L.esri.featureLayer('http://services1.arcgis.com/5rblLCKLgS4Td60j/ArcGIS/rest/services/HartfordMuniBikeLanes/FeatureServer/0',{
	// 	style: function () {
  //         	return { color: "#00FF00", opacity: 0.7, weight: 5 };
  //       	}
	// });
	// controlLayers.addOverlay(gb10, 'Glastonbury 10 mile (blue)');
	//
	// var TrinGISMuniBikeLanes_Connex = L.esri.featureLayer('http://services1.arcgis.com/5rblLCKLgS4Td60j/ArcGIS/rest/services/HartfordMuniBikeLanes_Connex/FeatureServer/0',{
	// 	style: function () {
  //         	return { color: "#9BBB59", opacity: 0.7, weight: 5 };
  //       	}
	// });
	// controlLayers.addOverlay(gb10, 'Glastonbury 10 mile (blue)');

	var FVTC = new L.GPX("routes/FVTCJune28loop.gpx", {async: true, display_wpt:false});
	controlLayers.addOverlay(FVTC, 'Farmington Valley Canal Trail loop');

	// TO DO: improve positioning of controls
	var sidebar = L.control.sidebar('sidebar').addTo(map);
	//sidebar.open('home');   -- option to open on startup

	//esri-leaflet popup
	// TrinGISPrimaryRoutes.bindPopup(function (feature) {
  //   	return L.Util.template('<p>Primary Route<br>FID: {FID}</p>', feature.properties);
  // 	});
	</script>
</body>
</html>
